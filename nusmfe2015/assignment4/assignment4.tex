\documentclass[12pt,a4paper,hidelinks,fleqn]{article}            % Article 12pt font for a4 paper while hiding links
\usepackage[margin=1in]{geometry}                          % Required to adjust margins
\input{styleAndCommands}
\title{\vspace{-5ex}Assignment 4, FE5116 (2014/2015, Semester 2)\vspace{-7ex}}
\date{}
\begin{document}
\maketitle

\subsection*{Excercise 4.1}
Price Asian call option with the one factor mean reverting commodity model (MR1)
\begin{align}
\frac{dF(t, T)}{F(t, T)} = \sigma e^{-\alpha (T- t)} dW_t
\end{align}
with constant $\sigma, \alpha > 0$.

The payoff of arithmetic Asian call option is $(A - K)_+$ where $A = \frac{1}{n}\sum_{i=1}^n F(t_i, T_i)$. 
You should use only one state variable $Z_t$ recommended in the lecture:
\begin{align}
& dZ_t = -\alpha Z_t dt + dW_t, \\
& Z_{t+\Delta t} = Z_t e^{-\alpha \Delta t} + \sqrt{v_t} \epsilon_t, \\
& v_t = \frac{1}{2\alpha}(1 - e^{-\alpha  \Delta t})
\end{align}
and the reconstruction
\begin{align}
F(t, T) & = F(0, T) \exp\left( -\frac{\sigma^2}{2} \int_0^t e^{-2\alpha (T - u)} du + \sigma e^{-\alpha(T-t)} Z_t \right) \\
        & = F(0, T) \exp\left( \frac{\sigma^2}{4\alpha} e^{-2\alpha T} \left(1 - e^{2\alpha t}\right) + \sigma e^{-\alpha(T-t)} Z_t \right).
\end{align}
Implement a Monte Carlo Asian call option pricer for this model:
\vspace{-0.6cm}
\begin{verbatim}
asianCallOptionMR1(rf, sigma, priceCurve, expiry, strike, ti_s, Ti_s, nSim)
 % rf: the constant risk-free interest rate
 % sigma: the model volatility
 % priceCurve: priceCurve(t) = F(0, t), the future prices observed today 
 % expiry: the option expiry
 % strike: the option strike
 % ti_s: array of double, the ti's in the averaging period
 % Ti_s: array of double, the futures delivery time corresponding to ti
 % nSim: number of Monte Carlo simulation paths
\end{verbatim}
\vspace{-0.6cm}
The \verb=priceCurve= function can be generated by, for example, linearly interpolating the below observations with flat extrapolation:
\vspace{-0.6cm}
\begin{verbatim}
  delivs = [1/12, 2/12, 3/12, 6/12, 9/12, 1, 1.5, 2, 3, 5];
  prices = [43, 45, 47, 49.05, 50.37, 51.36, 52.3, 53.51, 54.6, 55.7];
\end{verbatim}
You are not required to check the validity of the inputs:
the observation time \verb=ti= will always be smaller than the \verb=expiry=, and the futures delivery time \verb=Ti= will always be larger than the \verb=expiry=.
For example, an Asian option expiring in 1 year with 10 observations may have \verb_expiry = 1_, \verb+ti_s = [0.1, 0.2, ...1]+, and \verb+ti_s = [1.1, 1.2, ...2]+.

(Note that this exercise can be used to benchmark a degenerated case of the project.)
\subsection*{Excercise 4.2}
A quanto option (\url{http://en.wikipedia.org/wiki/Quanto}), unlike a normal European option that pays the final payoff in the denominated currency of the underlying stock or asset,
it pays the final payoff in another currency at a pre-determined exchange rate.
For example, a dividend-free stock $S_a$ is listed in SGX and denominatd in SGD. 
A quanto call option allows the holder to receive the payoff $(S_a-K)_+$ in CNY at a pre-fixed exchange rate $F = 5$. 

The payoff of the quanto call option in the stock's denominatd currency is thus 
$F \times (S_a(T)-K)_+ \times S_b(T)$ where $S_b$ is the value of one quanto currency in the unit of stock's denominated currency.

To price the option with Monte Carlo, one would need to simulate two assets: the stock $S_a$ and the exchange rate $S_b$.
Consider the below diffusion:
\begin{align}
& dS_a(t) / S_a(t) = r dt + \sigma_a dW_a \\
& dS_b(t) / S_b(t) = \mu dt + \sigma_b dW_b \\
& dW_a dW_b = \rho dt
\end{align}

Implement a Monte Carlo pricer to price the quanto call option
\begin{verbatim}
quantoCallOptionMC(r, mu, sigmaA, sigmaB, rho, s_a0, s_b0, T, K, F, nSim)
\end{verbatim}
where \verb=s_a0= and \verb=s_b0= are the current spot prices $S_a(0)$ and $S_b(0)$.
\subsection*{Excercise 4.3}
Let us price derivatives with PDE for the one factor mean reverting model (MR1). 
Recall what we have seen in Exercise 3.1 the model diffusion:
\begin{align*}
\frac{dF(t, T)}{F(t, T)} = \sigma e^{-\alpha (T- t)} dW_t,
\end{align*}
our choice of state variable
\begin{align}
dZ_t = -\alpha Z_t dt + dW_t,
\end{align}
and the reconstruction for the futures prices:
\begin{align}
F(t, T) & = F(0, T) \exp\left( -\frac{\sigma^2}{2} \int_0^t e^{-2\alpha (T - u)} du + \sigma e^{-\alpha(T-t)} Z_t \right) \\
        & = F(0, T) \exp\left( \frac{\sigma^2}{4\alpha} e^{-2\alpha T} \left(1 - e^{2\alpha t}\right) + \sigma e^{-\alpha(T-t)} Z_t \right).
\label{eq:mr1_reconstruction}
\end{align}
A derivative contract contingent on the value of $F(t, T)$ can be expressed as a derivative on the state variable $Z(t)$ through \eqref{eq:mr1_reconstruction}.
The price of the derivative contract $V(t, Z(t))$ follows the SDE:
\begin{align}
dU & = \frac{\partial U}{\partial t} dt + \frac{\partial U}{\partial Z} dZ + \frac{1}{2}\frac{\partial^2 U}{\partial Z^2} dZ^2 \\
   & = \left(\frac{\partial U}{\partial t} - \alpha Z\frac{\partial U}{\partial Z} + \frac{1}{2} \frac{\partial^2 U}{\partial Z^2} \right)dt + \frac{\partial U}{\partial Z} dW_t
\end{align}
Assuming the interest rate is constant $r$, the expected growth rate of the derivative should be the same as the risk-free rate, yielding the PDE that $U(t, Z_t)$ has to satisfy:
\begin{align}
rU(t) = \frac{\partial U(t)}{\partial t} - \alpha Z(t) \frac{\partial U(t)}{\partial Z} + \frac{1}{2} \frac{\partial^2 U(t)}{\partial Z^2}
\end{align}

Now, develop a PDE pricer that prices a European call option on the futures contract $F(t, T)$ with strike $K$ and expiry $t_e$ using implicit Euler scheme, with $Z_t$ as state variable.
The payoff at time $t_e$ of the function is $[F(t_e, T) - K]_+$.
You should describe how to set up the initial value at the terminal time step $t_e$, the boundary conditions, and implement the pricer with the below signature:
\begin{verbatim}
callOnFuturesPDE(priceCurve, expiry, T, K, nT, nZ)
\end{verbatim}
where the nT and nZ are the number of subdivisions for the time axis and state variable axis.

\subsection*{Excercise 4.4}


\subsection*{Submission Checklist}
Below is the list of required files in the submission package:
\begin{itemize}
\item Exercise 4.1: 
\item Exercise 4.2: 
\end{itemize}
You do not need to create sub-folders for the questions. 
To re-iterate, the filename of the zip file should be in the format of \verb=Ex3_name1_matricNumber1_name2_matricNumber2.zip=.
And the matric number should contain the last alphabetic letter if applicable. 

\end{document}